{"version":3,"sources":["../immerser.js","DOM.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["Immerser","options","defaults","immerserSelector","value","description","overwritable","layerSelector","solidSelector","pagerSelector","solidClassnames","validator","x","pagerTreshold","immerserClassname","classnameValidator","immerserWrapperClassname","immerserMaskClassname","pagerClassname","pagerLinkClassname","pagerLinkActiveClassname","immerserNode","immerserClassnames","states","documentHeight","windowHeight","resizeTimerId","init","setWindowSizes","setLayerSizes","setStates","createPagerLinks","createDOMStructure","initPagerLinks","draw","window","addEventListener","bind","onResize","document","querySelector","console","warn","layerNodeList","querySelectorAll","forEachNode","layerNode","push","JSON","parse","dataset","node","top","bottom","documentElement","offsetHeight","innerHeight","map","state","offsetTop","index","isFirst","isLast","length","immerserHeight","immerserTop","startEnter","enter","startLeave","leave","height","pagerNode","classList","add","forEach","layerId","id","pagerLinkNode","createElement","href","stateIndex","appendChild","pagerLinkNodeArray","maskAndWrapperStyles","position","right","left","overflow","originalChildrenNodeList","wrapper","applyStyles","childNode","clonnedChildNode","cloneNode","clonedSolidNodeList","solidId","immerserSolidId","hasOwnProperty","mask","setAttribute","maskNode","wrapperNode","pagerLinkHTMLCollection","getElementsByClassName","y","getLastScrollPositionY","progress","style","transform","pagerScrollActivePoint","remove","clearTimeout","setTimeout","Math","min","max","scrollTop","styles","rule","nodeList","callback","string","test","my","log","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","getElementById","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"DOM.a5443197.js","sourceRoot":"..\\example","sourcesContent":["export default class Immerser {\r\n  constructor(options) {\r\n    this.defaults = {\r\n      immerserSelector: {\r\n        value: '[data-immerser]',\r\n        description: 'valid CSS selector',\r\n        overwritable: false\r\n      },\r\n      layerSelector: {\r\n        value: '[data-immerser-classnames]',\r\n        description: 'valid CSS selector',\r\n        overwritable: false\r\n      },\r\n      solidSelector: {\r\n        value: '[data-immerser-solid-id]',\r\n        description: 'valid CSS selector',\r\n        overwritable: false\r\n      },\r\n      pagerSelector: {\r\n        value: '[data-immerser-pager]',\r\n        description: 'valid CSS selector',\r\n        overwritable: false\r\n      },\r\n      solidClassnames: {\r\n        value: null,\r\n        description: 'an array of objects',\r\n        validator: x => true,\r\n      },\r\n      pagerTreshold: {\r\n        value: 0.5,\r\n        description: 'a number between 0 and 1',\r\n        validator: x => typeof x === 'number' && 0 <= x && x <= 1,\r\n      },\r\n      immerserClassname: {\r\n        value: 'immerser',\r\n        description: 'valid non empty classname string',\r\n        validator: this.classnameValidator,\r\n      },\r\n      immerserWrapperClassname: {\r\n        value: 'immerser__wrapper',\r\n        description: 'valid non empty classname string',\r\n        validator: this.classnameValidator,\r\n      },\r\n      immerserMaskClassname: {\r\n        value: 'immerser__mask',\r\n        description: 'valid non empty classname string',\r\n        validator: this.classnameValidator,\r\n      },\r\n      pagerClassname: {\r\n        value: 'pager',\r\n        description: 'valid non empty classname string',\r\n        validator: this.classnameValidator,\r\n      },\r\n      pagerLinkClassname: {\r\n        value: 'pager__link',\r\n        description: 'valid non empty classname string',\r\n        validator: this.classnameValidator,\r\n      },\r\n      pagerLinkActiveClassname: {\r\n        value: 'pager__link--active',\r\n        description: 'valid non empty classname string',\r\n        validator: this.classnameValidator,\r\n      },\r\n    };\r\n    \r\n    // TODO user defined solid layout\r\n\r\n    // TODO validate options\r\n    this.options = { ...this.defaults, ...options };\r\n\r\n    // state\r\n    this.immerserNode = null;\r\n    this.immerserClassnames = [];\r\n    this.states = [];\r\n    this.documentHeight = 0;\r\n    this.windowHeight = 0;\r\n    this.resizeTimerId = null;\r\n\r\n    this.init();\r\n    this.setWindowSizes();\r\n    this.setLayerSizes();\r\n    this.setStates();\r\n    this.createPagerLinks(options);\r\n    this.createDOMStructure();\r\n    this.initPagerLinks();\r\n    this.draw();\r\n\r\n    window.addEventListener('scroll', this.draw.bind(this), false);\r\n    window.addEventListener('resize', this.onResize.bind(this), false);\r\n  }\r\n\r\n  init() {\r\n    this.immerserNode = document.querySelector(this.options.immerserSelector);\r\n    if (!this.immerserNode) {\r\n      console.warn('Immerser element not found. Check documentation https://github.com/dubaua/immerser');\r\n    }\r\n\r\n    if (this.options.solidClassnames) {\r\n      this.immerserClassnames = this.options.solidClassnames;\r\n    }\r\n    const layerNodeList = document.querySelectorAll(this.options.layerSelector);\r\n    this.forEachNode(layerNodeList, layerNode => {\r\n      if (!this.options.solidClassnames) {\r\n        this.immerserClassnames.push(JSON.parse(layerNode.dataset.immerserClassnames));\r\n      }\r\n      this.states.push({\r\n        node: layerNode,\r\n        top: 0,\r\n        bottom: 0,\r\n      });\r\n    });\r\n    // warn if no classnames given\r\n  }\r\n\r\n  setWindowSizes() {\r\n    this.documentHeight = document.documentElement.offsetHeight;\r\n    this.windowHeight = window.innerHeight;\r\n  }\r\n\r\n  setLayerSizes() {\r\n    this.states = this.states.map(state => {\r\n      const top = state.node.offsetTop;\r\n      const bottom = top + state.node.offsetHeight;\r\n      return {\r\n        ...state,\r\n        top,\r\n        bottom,\r\n      };\r\n    });\r\n  }\r\n\r\n  setStates() {\r\n    this.states = this.states.map((state, index) => {\r\n      const isFirst = index === 0;\r\n      const isLast = index === this.states.length - 1;\r\n\r\n      const immerserHeight = this.immerserNode.offsetHeight;\r\n      const immerserTop = this.immerserNode.offsetTop;\r\n\r\n      // actually not 0 and this.documentHeight but start of first and end of last.\r\n      const startEnter = isFirst ? 0 : immerserTop + this.states[index - 1].top; // == previous start\r\n      const enter = isFirst ? 0 : startEnter + immerserHeight;\r\n      const startLeave = isLast ? this.documentHeight : immerserTop + this.states[index].top;\r\n      const leave = isLast ? this.documentHeight : startLeave + immerserHeight;\r\n\r\n      return {\r\n        ...state,\r\n        startEnter,\r\n        enter,\r\n        startLeave,\r\n        leave,\r\n        height: immerserHeight,\r\n      };\r\n    });\r\n  }\r\n\r\n  createPagerLinks() {\r\n    const pagerNode = document.querySelector(this.options.pagerSelector);\r\n    if (!pagerNode) return;\r\n\r\n    const { pagerClassname, pagerLinkClassname } = this.options;\r\n    pagerNode.classList.add(pagerClassname);\r\n\r\n    this.states.forEach((state, index) => {\r\n      let layerId = state.node.id;\r\n\r\n      // if no layerId create it, to point anchor to\r\n      if (layerId === '') {\r\n        layerId = `immerser-section-${index}`;\r\n        state.node.id = layerId;\r\n      }\r\n\r\n      const pagerLinkNode = document.createElement('a');\r\n      pagerLinkNode.classList.add(pagerLinkClassname);\r\n      pagerLinkNode.href = `#${layerId}`;\r\n      // not the best way to store index for\r\n      pagerLinkNode.dataset.stateIndex = index;\r\n      pagerNode.appendChild(pagerLinkNode);\r\n\r\n      state.pagerLinkNodeArray = [];\r\n    });\r\n  }\r\n\r\n  createDOMStructure() {\r\n    const maskAndWrapperStyles = {\r\n      position: 'absolute',\r\n      top: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      left: 0,\r\n      overflow: 'hidden',\r\n    };\r\n\r\n    const { immerserClassname, immerserWrapperClassname, immerserMaskClassname } = this.options;\r\n    const originalChildrenNodeList = this.immerserNode.querySelectorAll(this.options.solidSelector);\r\n    this.immerserNode.classList.add(immerserClassname);\r\n\r\n    this.states = this.states.map((state, stateIndex) => {\r\n      const wrapper = document.createElement('div');\r\n      this.applyStyles(wrapper, maskAndWrapperStyles);\r\n      wrapper.classList.add(immerserWrapperClassname);\r\n\r\n      this.forEachNode(originalChildrenNodeList, childNode => {\r\n        const clonnedChildNode = childNode.cloneNode(true);\r\n        wrapper.appendChild(clonnedChildNode);\r\n        // TODO remove original children. mess with DOM\r\n      });\r\n\r\n      // TODO achieve hovering with linking clonned elements\r\n\r\n      const clonedSolidNodeList = wrapper.querySelectorAll(this.options.solidSelector);\r\n      this.forEachNode(clonedSolidNodeList, ({ dataset, classList }) => {\r\n        const solidId = dataset.immerserSolidId;\r\n        if (this.immerserClassnames[stateIndex].hasOwnProperty(solidId)) {\r\n          classList.add(this.immerserClassnames[stateIndex][solidId]);\r\n        }\r\n      });\r\n\r\n      const mask = document.createElement('div');\r\n      this.applyStyles(mask, maskAndWrapperStyles);\r\n      mask.classList.add(immerserMaskClassname);\r\n\r\n      if (stateIndex !== 0) {\r\n        mask.setAttribute('aria-hidden', 'true');\r\n      }\r\n      mask.appendChild(wrapper);\r\n      this.immerserNode.appendChild(mask);\r\n\r\n      state.maskNode = mask;\r\n      state.wrapperNode = wrapper;\r\n      return state;\r\n    });\r\n  }\r\n\r\n  initPagerLinks() {\r\n    const pagerLinkHTMLCollection = this.immerserNode.getElementsByClassName(this.options.pagerLinkClassname);\r\n    for (let index = 0; index < pagerLinkHTMLCollection.length; index++) {\r\n      const pagerLinkNode = pagerLinkHTMLCollection[index];\r\n      const stateIndex = pagerLinkNode.dataset.stateIndex;\r\n      this.states[stateIndex].pagerLinkNodeArray.push(pagerLinkNode);\r\n    }\r\n  }\r\n\r\n  draw() {\r\n    const y = this.getLastScrollPositionY();\r\n    this.states.forEach(\r\n      ({ startEnter, enter, startLeave, leave, height, maskNode, wrapperNode, top, bottom, pagerLinkNodeArray }) => {\r\n        let progress;\r\n        if (startEnter > y) {\r\n          progress = height;\r\n        } else if (startEnter <= y && y < enter) {\r\n          progress = enter - y;\r\n        } else if (enter <= y && y < startLeave) {\r\n          progress = 0;\r\n        } else if (startLeave <= y && y < leave) {\r\n          progress = startLeave - y;\r\n        } else {\r\n          progress = -height;\r\n        }\r\n        maskNode.style.transform = `translateY(${progress}px)`;\r\n        wrapperNode.style.transform = `translateY(${-progress}px)`;\r\n\r\n        // check if pager\r\n        const pagerScrollActivePoint = y + this.windowHeight * this.options.pagerTreshold;\r\n        if (top <= pagerScrollActivePoint && pagerScrollActivePoint < bottom) {\r\n          pagerLinkNodeArray.forEach(({ classList }) => {\r\n            classList.add(this.options.pagerLinkActiveClassname);\r\n          });\r\n        } else {\r\n          pagerLinkNodeArray.forEach(({ classList }) => {\r\n            classList.remove(this.options.pagerLinkActiveClassname);\r\n          });\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  onResize() {\r\n    // TODO maybe refactor on requestAnimationFrame\r\n    // simlpe debouncer\r\n    clearTimeout(this.resizeTimerId);\r\n    this.resizeTimerId = setTimeout(() => {\r\n      this.setWindowSizes();\r\n      this.setLayerSizes();\r\n      this.setStates();\r\n      this.draw();\r\n    }, 16);\r\n  }\r\n\r\n  // utils\r\n  getLastScrollPositionY() {\r\n    // limit scroll position between 0 and document height in case of iOS overflow scroll\r\n    return Math.min(Math.max(document.documentElement.scrollTop, 0), this.documentHeight);\r\n  }\r\n\r\n  applyStyles({ style }, styles) {\r\n    for (const rule in styles) {\r\n      style[rule] = styles[rule];\r\n    }\r\n  }\r\n\r\n  forEachNode(nodeList, callback) {\r\n    for (let index = 0; index < nodeList.length; index++) {\r\n      const node = nodeList[index];\r\n      callback(node, index, nodeList);\r\n    }\r\n  }\r\n\r\n  classnameValidator(string) {\r\n    return typeof string === 'string' && string !== '' && /^[a-z_-][a-z\\d_-]*$/i.test(string);\r\n  }\r\n}\r\n","import Immerser from '../immerser.js';\n\nconst my = new Immerser();\n\nconsole.log(my);\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else {\n        window.location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}