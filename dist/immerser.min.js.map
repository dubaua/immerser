{"version":3,"file":"immerser.min.js","mappings":"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","sources":["webpack://Immerser/webpack/universalModuleDefinition","webpack://Immerser/./node_modules/@dubaua/observable/dist/observable.min.js","webpack://Immerser/./node_modules/@dubaua/merge-options/dist/merge-options.min.js","webpack://Immerser/webpack/bootstrap","webpack://Immerser/webpack/runtime/compat get default export","webpack://Immerser/webpack/runtime/define property getters","webpack://Immerser/webpack/runtime/hasOwnProperty shorthand","webpack://Immerser/./src/defaults.ts","webpack://Immerser/./src/utils.ts","webpack://Immerser/./src/immerser.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Immerser\"] = factory();\n\telse\n\t\troot[\"Immerser\"] = factory();\n})(this, () => {\nreturn ","\"use strict\";function t(t){var e=function(t){if(\"object\"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,\"string\");if(\"object\"!=typeof r)return r;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return String(t)}(t);return\"symbol\"==typeof e?e:e+\"\"}module.exports=/*#__PURE__*/function(){function Observable(t){this.callbacks=[],this.internal=t}var e,r;return Observable.prototype.subscribe=function(t){var e=this;if(\"function\"!=typeof t)throw new TypeError(\"[createObservable]: expected callback to be a function.\");return this.callbacks.push(t),function(){var r=e.callbacks.indexOf(t);e.callbacks=e.callbacks.slice(0,r).concat(e.callbacks.slice(r+1))}},e=Observable,(r=[{key:\"value\",get:function(){return this.internal},set:function(t){if(t!==this.internal){var e=this.internal;this.internal=t;for(var r=0;r<this.callbacks.length;r++)this.callbacks[r](this.internal,e)}}}])&&function(e,r){for(var i=0;i<r.length;i++){var n=r[i];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,t(n.key),n)}}(e.prototype,r),Object.defineProperty(e,\"prototype\",{writable:!1}),e}();\n//# sourceMappingURL=observable.min.js.map\n","\"use strict\";function o(o,e){return Object.prototype.hasOwnProperty.call(o,e)}function e(o){return null!==o&&\"object\"==typeof o&&!1===Array.isArray(o)}function t(e){var t=e.optionConfig,i=e.userOptions,r=void 0===i?{}:i,n=e.prefix,a=void 0===n?\"\":n,f=e.suffix,u=void 0===f?\"\":f,p=e.strict,d=void 0===p||p,c=function(o){return[a,o,u].join(\" \")},s={};for(var l in t)if(o(t,l)){var g=t[l],v=g.required,y=g.default,b=g.description,x=g.validator,h=r[l],q=!!o(g,\"required\")&&(\"function\"==typeof v?v(r):v),E=o(r,l),w=x(h,r);if(q){if(!E)throw new TypeError(c(l+\" is required.\"));if(!w)throw new TypeError(c(\"Expected \"+l+\" to be \"+b+\", got \"+typeof h+\" \"+h+\".\"));s[l]=h}else if(s[l]=y,E)if(w)s[l]=h;else{if(d)throw new TypeError(c(\"Expected \"+l+\" to be \"+b+\", got \"+typeof h+\" \"+h+\".\"));console.warn(c(\"Expected \"+l+\" to be \"+b+\", got \"+typeof h+\" \"+h+\". Fallback to default value \"+y+\".\"))}}return s}var i=\"[mergeOptions]:\",r=\"\\nCheck out documentation https://github.com/dubaua/merge-options#parameters-and-return\";function n(o){throw new TypeError([i,o,r].join(\" \"))}var a={optionConfig:{required:!0,validator:function(t){for(var i in t)if(o(t,i)){var r=t[i];if(e(r)||n(\"Expected optionConfig.\"+i+\" to be an object with declarative option configuration, got \"+typeof r+\" \"+r+\".\"),o(r,\"required\")){var a=r.required,f=typeof a;\"boolean\"!==f&&\"function\"!==f&&n(\"Expected optionConfig.\"+i+\".required to be either boolean or function, got \"+typeof a+\" \"+a+\".\")}else o(r,\"default\")||n(\"Expected optionConfig.\"+i+\" to either have required or default value.\");if(o(r,\"default\")||o(r,\"required\")||n(\"Expected optionConfig.\"+i+\" to either have required or default value.\"),o(r,\"description\")){var u=r.description;\"string\"!=typeof r.description&&n(\"Expected optionConfig.\"+i+\".description to be a string, got \"+typeof u+\" \"+u+\".\")}else n(\"Missing description on optionConfig.\"+i+\" config.\");if(o(r,\"validator\")){var p=r.validator;\"function\"!=typeof r.validator&&n(\"Expected optionConfig.\"+i+\".validator to be a function, got \"+typeof p+\" \"+p+\".\")}else n(\"Missing validator on optionConfig.\"+i+\" config.\")}return e(t)},description:\"an object with declarative option configuration\"},userOptions:{required:!1,default:{},validator:e,description:\"an object\"},prefix:{required:!1,default:\"\",validator:function(o){return\"string\"==typeof o},description:\"a string\"},suffix:{required:!1,default:\"\",validator:function(o){return\"string\"==typeof o},description:\"a string\"},strict:{required:!1,default:!0,validator:function(o){return\"boolean\"==typeof o},description:\"a boolean\"}};module.exports=function(o){var e=t({optionConfig:a,userOptions:o,prefix:i,suffix:r});return t(e)};\n//# sourceMappingURL=merge-options.min.js.map\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const CLASSNAME_REGEX = /^[a-z_-][a-z\\d_-]*$/i;\n\nfunction classnameValidator(str: string): boolean {\n  return typeof str === 'string' && str !== '' && CLASSNAME_REGEX.test(str);\n}\n\ninterface OptionConfigItem {\n  default: any;\n  description: string;\n  validator: (x: any) => boolean;\n}\n\nconst OPTION_CONFIG: Record<string, OptionConfigItem> = {\n  solidClassnameArray: {\r\n    default: [],\r\n    description: 'non empty array of objects',\r\n    validator: (x) => Array.isArray(x) && x.length !== 0,\r\n  },\r\n  fromViewportWidth: {\r\n    default: 0,\r\n    description: 'a natural number',\r\n    validator: (x) => typeof x === 'number' && 0 <= x && x % 1 === 0,\r\n  },\r\n  pagerThreshold: {\r\n    default: 0.5,\r\n    description: 'a number between 0 and 1',\r\n    validator: (x) => typeof x === 'number' && 0 <= x && x <= 1,\r\n  },\r\n  hasToUpdateHash: {\r\n    default: false,\r\n    description: 'a boolean',\r\n    validator: (x) => typeof x === 'boolean',\r\n  },\r\n  scrollAdjustThreshold: {\r\n    default: 0,\r\n    description: 'a number greater than or equal to 0',\r\n    validator: (x) => typeof x === 'number' && x >= 0,\r\n  },\r\n  scrollAdjustDelay: {\r\n    default: 600,\r\n    description: 'a number greater than or equal to 300',\r\n    validator: (x) => typeof x === 'number' && x >= 300,\r\n  },\r\n  pagerLinkActiveClassname: {\r\n    default: 'pager-link-active',\r\n    description: 'valid non empty classname string',\r\n    validator: classnameValidator,\r\n  },\r\n  isScrollHandled: {\r\n    default: true,\r\n    description: 'a boolean',\r\n    validator: (x) => typeof x === 'boolean',\r\n  },\r\n  onInit: {\r\n    default: null,\r\n    description: 'a function',\r\n    validator: (x) => typeof x === 'function',\r\n  },\r\n  onBind: {\r\n    default: null,\r\n    description: 'a function',\r\n    validator: (x) => typeof x === 'function',\r\n  },\r\n  onUnbind: {\r\n    default: null,\r\n    description: 'a function',\r\n    validator: (x) => typeof x === 'function',\r\n  },\r\n  onDestroy: {\r\n    default: null,\r\n    description: 'a function',\r\n    validator: (x) => typeof x === 'function',\r\n  },\r\n  onActiveLayerChange: {\r\n    default: null,\r\n    description: 'a function',\r\n    validator: (x) => typeof x === 'function',\r\n  },\r\n};\n\nconst MESSAGE_PREFFIX = '[immmerser:]';\n\nexport { OPTION_CONFIG, MESSAGE_PREFFIX };\n","import { MESSAGE_PREFFIX } from '@/defaults';\n\r\nexport function bindStyles(node: HTMLElement, styles: { [key: string]: string }): void {\n  for (const rule in styles) {\n    (node.style as any)[rule] = styles[rule];\n  }\n}\n\nexport function forEachNode<T extends Element>(nodeList: ArrayLike<T>, callback: (node: T, index: number, nodeList: ArrayLike<T>) => void): void {\n  for (let index = 0; index < nodeList.length; index++) {\n    const node = nodeList[index];\n    callback(node, index, nodeList);\n  }\n}\n\nexport function getNodeArray({ selector, parent = document }: { selector: string; parent?: Document | Element | null }): Element[] {\n  if (!parent) {\n    return [];\n  }\n  const nodeList = parent.querySelectorAll(selector);\n  return [].slice.call(nodeList);\n}\n\nexport function showError({ message, warning = false, docs }: { message: string; warning?: boolean; docs?: string }): void {\n  const docsHash = docs ? docs : '';\n  const resultMessage = `${MESSAGE_PREFFIX} ${message} \\nCheck out documentation https://github.com/dubaua/immerser${docsHash}`;\n  if (warning) {\n    console.warn(resultMessage);\n  } else {\n    throw new Error(resultMessage);\n  }\n}\n\nexport function isEmpty(obj?: Record<string, any> | null): boolean {\n  if (!obj) {\n    return true;\n  }\n  return Object.keys(obj).length === 0 && obj.constructor === Object;\n}\n\nexport function limit(number: number, min: number, max: number): number {\n  return Math.max(Math.min(number, max), min);\n}\n\nexport function getLastScrollPosition(): { x: number; y: number } {\n  const scrollX = window.scrollX || document.documentElement.scrollLeft;\n  const scrollY = window.scrollY || document.documentElement.scrollTop;\n  // limit scroll position between 0 and document height in case of iOS overflow scroll\n  return {\n    x: limit(scrollX, 0, document.documentElement.offsetWidth),\n    y: limit(scrollY, 0, document.documentElement.offsetHeight),\n  };\n}\n","import mergeOptions from '@dubaua/merge-options';\r\nimport Observable from '@dubaua/observable';\nimport { MESSAGE_PREFFIX, OPTION_CONFIG } from '@/defaults';\nimport { bindStyles, forEachNode, getLastScrollPosition, getNodeArray, isEmpty, showError } from '@/utils';\n\r\nconst CROPPED_FULL_ABSOLUTE_STYLES = {\r\n  position: 'absolute',\r\n  top: 0,\r\n  right: 0,\r\n  bottom: 0,\r\n  left: 0,\r\n  overflow: 'hidden',\r\n};\r\n\r\nconst NOT_INTERACTIVE_STYLES = {\r\n  pointerEvents: 'none',\r\n  touchAction: 'none',\r\n};\r\n\r\nconst INTERACTIVE_STYLES = {\n  pointerEvents: 'all',\n  touchAction: 'auto',\n};\n\ninterface SolidClassnames {\n  [key: string]: string;\n}\n\ninterface State {\n  beginEnter: number;\n  beginLeave: number;\n  endEnter: number;\n  endLeave: number;\n  id: string;\n  layerBottom: number;\n  layerTop: number;\n  maskInnerNode: HTMLElement | null;\n  maskNode: HTMLElement | null;\n  layerNode: HTMLElement;\n  solidClassnames: SolidClassnames | null;\n}\n\ninterface Options {\n  solidClassnameArray: SolidClassnames[];\n  fromViewportWidth: number;\n  pagerThreshold: number;\n  hasToUpdateHash: boolean;\n  scrollAdjustThreshold: number;\n  scrollAdjustDelay: number;\n  pagerLinkActiveClassname: string;\n  isScrollHandled: boolean;\n  onInit: ((immerser: Immerser) => void) | null;\n  onBind: ((immerser: Immerser) => void) | null;\n  onUnbind: ((immerser: Immerser) => void) | null;\n  onDestroy: ((immerser: Immerser) => void) | null;\n  onActiveLayerChange: ((layerIndex: number, immerser: Immerser) => void) | null;\n}\n\nexport default class Immerser {\n  options: Options = {} as Options;\n  selectors = {\n    root: '[data-immerser]',\n    layer: '[data-immerser-layer]',\n    solid: '[data-immerser-solid]',\n    pagerLink: '[data-immerser-pager-link]',\n    mask: '[data-immerser-mask]',\n    maskInner: '[data-immerser-mask-inner]',\n    synchroHover: '[data-immerser-synchro-hover]',\n  };\n  stateArray: State[] = [];\n  stateIndexById: Record<string, number> = {};\n  isBound = false;\n  rootNode: HTMLElement | null = null;\n  layerNodeArray: HTMLElement[] = [];\n  solidNodeArray: HTMLElement[] = [];\n  pagerLinkNodeArray: HTMLElement[] = [];\n  originalSolidNodeArray: HTMLElement[] = [];\n  maskNodeArray: HTMLElement[] = [];\n  synchroHoverNodeArray: HTMLElement[] = [];\n  isCustomMarkup = false;\n  customMaskNodeArray: HTMLElement[] = [];\n  documentHeight = 0;\n  windowHeight = 0;\n  immerserTop = 0;\n  immerserHeight = 0;\n  resizeFrameId: number | null = null;\n  scrollFrameId: number | null = null;\n  scrollAdjustTimerId: ReturnType<typeof setTimeout> | null = null;\n  reactiveActiveLayer: Observable<number | undefined> = new Observable<number | undefined>();\n  reactiveWindowWidth: Observable<number> = new Observable<number>();\n  reactiveSynchroHoverId: Observable<string | undefined> = new Observable<string | undefined>();\n  stopRedrawingPager: (() => void) | null = null;\n  stopUpdatingHash: (() => void) | null = null;\n  stopFiringActiveLayerChangeCallback: (() => void) | null = null;\n  stopTrackingSynchroHover: (() => void) | null = null;\n  stopToggleBindOnRezise: (() => void) | null = null;\n  onResize: (() => void) | null = null;\n  onScroll: (() => void) | null = null;\n  onSynchroHoverMouseOver: ((e: MouseEvent) => void) | null = null;\n  onSynchroHoverMouseOut: (() => void) | null = null;\n\n  constructor(userOptions?: Partial<Options>) {\n    this.init(userOptions);\n  }\n\n  init(userOptions?: Partial<Options>): void {\n    this.setNodes();\r\n    this.validateMarkup();\r\n    this.mergeOptions(userOptions);\r\n    this.getClassnamesFromMarkup();\r\n    this.validateSolidClassnameArray();\r\n    this.initSectionIds();\r\n    this.initStatemap();\r\n    this.validateClassnames();\r\n    this.toggleBindOnRezise();\r\n    this.setSizes();\r\n    this.addScrollAndResizeListeners();\r\n    if (typeof this.options.onInit === 'function') {\r\n      this.options.onInit(this);\r\n    }\r\n  }\r\n\r\n  setNodes(): void {\n    this.rootNode = document.querySelector(this.selectors.root);\n    this.layerNodeArray = getNodeArray({ selector: this.selectors.layer });\n    this.solidNodeArray = getNodeArray({ selector: this.selectors.solid, parent: this.rootNode });\n  }\n\n  validateMarkup(): void {\n    if (!this.rootNode) {\n      showError({\n        message: 'immerser root node not found.',\n        docs: '#prepare-your-markup',\n      });\n    }\r\n    if (this.layerNodeArray.length < 0) {\r\n      showError({\r\n        message: 'immerser will not work without layer nodes.',\r\n        docs: '#prepare-your-markup',\r\n      });\r\n    }\r\n    if (this.solidNodeArray.length < 0) {\r\n      showError({\r\n        message: 'immerser will not work without solid nodes.',\r\n        docs: '#prepare-your-markup',\r\n      });\r\n    }\r\n  }\n\n  mergeOptions(userOptions?: Partial<Options>): void {\n    this.options = mergeOptions({\n      optionConfig: OPTION_CONFIG,\n      userOptions,\n      preffix: MESSAGE_PREFFIX,\n      suffix: '\\nCheck out documentation https://github.com/dubaua/immerser#options',\n    }) as Options;\n  }\n\n  getClassnamesFromMarkup(): void {\n    this.layerNodeArray.forEach((layerNode, layerIndex) => {\n      if (layerNode.dataset.immerserLayerConfig) {\n        try {\n          this.options.solidClassnameArray[layerIndex] = JSON.parse(layerNode.dataset.immerserLayerConfig);\n        } catch (e) {\n          console.error(MESSAGE_PREFFIX, 'Failed to parse JSON classname configuration.', e);\r\n        }\r\n      }\r\n    });\r\n  }\n\n  validateSolidClassnameArray(): void {\n    const layerCount = this.layerNodeArray.length;\n    const classnamesCount = this.options.solidClassnameArray.length;\n    if (classnamesCount !== layerCount) {\n      showError({\n        message: 'solidClassnameArray length differs from count of layers',\n        docs: '#options',\r\n      });\r\n    }\r\n  }\r\n\r\n  initSectionIds(): void {\n    this.layerNodeArray.forEach((layerNode, layerIndex) => {\n      let id = layerNode.id;\n      if (!id) {\n        id = `immerser-section-${layerIndex}`;\n        layerNode.id = id;\n        (layerNode as any).__immerserCustomId = true;\n      }\n      this.stateIndexById[id] = layerIndex;\n    });\n  }\n\n  initStatemap(): void {\n    this.stateArray = this.layerNodeArray.map((layerNode, layerIndex) => {\n      const solidClassnames = this.options.solidClassnameArray[layerIndex];\n      const { id } = layerNode;\n      return {\n        beginEnter: 0,\n        beginLeave: 0,\n        endEnter: 0,\n        endLeave: 0,\n        id,\n        layerBottom: 0,\n        layerTop: 0,\n        maskInnerNode: null,\n        maskNode: null,\n        layerNode: layerNode,\n        solidClassnames,\n      } as State;\n    });\n  }\n\n  validateClassnames(): void {\n    const noClassnameConfigPassed = this.stateArray.every((state) => isEmpty(state.solidClassnames));\n    if (noClassnameConfigPassed) {\n      showError({\n        message: 'immerser will do nothing without solid classname configuration.',\n        docs: '#prepare-your-markup',\n      });\n    }\n  }\n\n  toggleBindOnRezise(): void {\n    this.stopToggleBindOnRezise = this.reactiveWindowWidth.subscribe((nextWindowWidth) => {\n      if (nextWindowWidth >= this.options.fromViewportWidth) {\n        if (!this.isBound) {\n          this.bind();\n        }\n      } else if (this.isBound) {\n        this.unbind();\n      }\n    });\n  }\n\n  setSizes(): void {\n    this.documentHeight = document.documentElement.offsetHeight;\n    this.windowHeight = window.innerHeight;\n    this.immerserTop = (this.rootNode as HTMLElement).offsetTop;\n    this.immerserHeight = (this.rootNode as HTMLElement).offsetHeight;\n\n    this.stateArray = this.stateArray.map((state) => {\n      const layerTop = state.layerNode.offsetTop;\n      const layerBottom = layerTop + state.layerNode.offsetHeight;\n\n      const endEnter = layerTop - this.immerserTop;\n      const beginEnter = endEnter - this.immerserHeight;\n      const endLeave = layerBottom - this.immerserTop;\n      const beginLeave = endLeave - this.immerserHeight;\n\n      return {\n        ...state,\n        layerTop,\n        layerBottom,\n        beginEnter,\n        endEnter,\n        beginLeave,\n        endLeave,\n      } as State;\n    });\n\n    this.reactiveWindowWidth.value = window.innerWidth;\n  }\n\n  addScrollAndResizeListeners(): void {\n    if (this.options.isScrollHandled) {\n      this.onScroll = this.handleScroll.bind(this);\n      window.addEventListener('scroll', this.onScroll, false);\n    }\n    this.onResize = this.handleResize.bind(this);\n    window.addEventListener('resize', this.onResize, false);\n  }\n\n  bind(): void {\n    this.createMarkup();\n    this.initPagerLinks();\n    this.initHoverSynchro();\n    this.attachCallbacks();\n    this.isBound = true;\n    this.draw();\n    if (typeof this.options.onBind === 'function') {\n      this.options.onBind(this);\n    }\n  }\n\n  unbind(): void {\n    this.detachCallbacks();\n    this.removeSyncroHoverListeners();\n    this.clearCustomSectionIds();\n    this.restoreOriginalSolidNodes();\n    this.cleanupClonnedMarkup();\n    this.isBound = false;\n    if (typeof this.options.onUnbind === 'function') {\n      this.options.onUnbind(this);\n    }\n    this.reactiveActiveLayer.value = undefined;\n  }\n\n  private resetInternalState(): void {\n    this.stateArray = [];\n    this.stateIndexById = {};\n    this.isBound = false;\n    this.rootNode = null;\n    this.layerNodeArray = [];\n    this.solidNodeArray = [];\n    this.pagerLinkNodeArray = [];\n    this.originalSolidNodeArray = [];\n    this.maskNodeArray = [];\n    this.synchroHoverNodeArray = [];\n    this.isCustomMarkup = false;\n    this.customMaskNodeArray = [];\n    this.documentHeight = 0;\n    this.windowHeight = 0;\n    this.immerserTop = 0;\n    this.immerserHeight = 0;\n    this.resizeFrameId = null;\n    this.scrollFrameId = null;\n    this.scrollAdjustTimerId = null;\n    this.reactiveActiveLayer = new Observable<number | undefined>();\n    this.reactiveWindowWidth = new Observable<number>();\n    this.reactiveSynchroHoverId = new Observable<string | undefined>();\n    this.stopRedrawingPager = null;\n    this.stopUpdatingHash = null;\n    this.stopFiringActiveLayerChangeCallback = null;\n    this.stopTrackingSynchroHover = null;\n    this.stopToggleBindOnRezise = null;\n    this.onResize = null;\n    this.onScroll = null;\n    this.onSynchroHoverMouseOver = null;\n    this.onSynchroHoverMouseOut = null;\n  }\n\n  destroy(): void {\n    this.unbind();\n    this.stopToggleBindOnRezise?.();\n    this.removeScrollAndResizeListeners();\n    if (typeof this.options.onDestroy === 'function') {\n      this.options.onDestroy(this);\n    }\n    this.resetInternalState();\n  }\n\r\n  createMarkup(): void {\n    bindStyles(this.rootNode as HTMLElement, NOT_INTERACTIVE_STYLES);\n    this.initCustomMarkup();\n    this.originalSolidNodeArray = getNodeArray({ selector: this.selectors.solid, parent: this.rootNode });\n\r\n    this.stateArray = this.stateArray.map((state, stateIndex) => {\r\n      // create or assign existing markup, bind styles\r\n      const maskNode = this.isCustomMarkup ? this.customMaskNodeArray[stateIndex] : document.createElement('div');\n      bindStyles(maskNode, CROPPED_FULL_ABSOLUTE_STYLES);\n\r\n      const maskInnerNode = this.isCustomMarkup\r\n        ? maskNode.querySelector(this.selectors.maskInner)\r\n        : document.createElement('div');\r\n      bindStyles(maskInnerNode, CROPPED_FULL_ABSOLUTE_STYLES);\r\n\r\n      // mark created masks with data attributes\r\n      if (!this.isCustomMarkup) {\r\n        maskNode.dataset.immerserMask = '';\r\n        maskInnerNode.dataset.immerserMaskInner = '';\r\n      }\r\n\r\n      // clone solids to innerMask\r\n      this.originalSolidNodeArray.forEach((childNode) => {\r\n        const clonnedChildNode = childNode.cloneNode(true) as HTMLElement;\n        bindStyles(clonnedChildNode, INTERACTIVE_STYLES);\n        (clonnedChildNode as any).__immerserClonned = true;\n        maskInnerNode.appendChild(clonnedChildNode);\n      });\n\r\n      // assign class modifiers to cloned solids\r\n      const clonedSolidNodeList = maskInnerNode.querySelectorAll(this.selectors.solid);\r\n      forEachNode(clonedSolidNodeList, (clonedSolidNode) => {\r\n        const solidId = clonedSolidNode.dataset.immerserSolid;\r\n        if (state.solidClassnames && Object.prototype.hasOwnProperty.call(state.solidClassnames, solidId)) {\r\n          clonedSolidNode.classList.add(state.solidClassnames[solidId]);\r\n        }\r\n      });\r\n\r\n      // a11y\r\n      if (stateIndex !== 0) {\r\n        maskNode.setAttribute('aria-hidden', 'true');\r\n      }\r\n\r\n      maskNode.appendChild(maskInnerNode);\r\n      this.rootNode.appendChild(maskNode);\r\n\r\n      this.maskNodeArray.push(maskNode);\r\n\r\n      return { ...state, maskNode, maskInnerNode };\r\n    });\r\n\r\n    this.detachOriginalSolidNodes();\r\n  }\r\n\r\n  initCustomMarkup(): void {\n    this.customMaskNodeArray = getNodeArray({ selector: this.selectors.mask, parent: this.rootNode });\n    this.isCustomMarkup = this.customMaskNodeArray.length === this.stateArray.length;\n\n    if (this.customMaskNodeArray.length > 0 && !this.isCustomMarkup) {\n      showError({\n        message: 'You\\'re trying use custom markup, but count of your immerser masks doesn\\'t equal layers count.',\n        warning: true,\n        docs: '#cloning-event-listeners',\n      });\n    }\n\n    this.customMaskNodeArray.forEach((customMaskNode) => {\n      const customChildrenHTMLCollection = (customMaskNode.querySelector(this.selectors.maskInner) as HTMLElement).children;\n      for (let i = 0; i < customChildrenHTMLCollection.length; i++) {\n        bindStyles(customChildrenHTMLCollection[i] as HTMLElement, INTERACTIVE_STYLES);\n      }\n    });\n  }\n\n  detachOriginalSolidNodes(): void {\n    this.originalSolidNodeArray.forEach((childNode) => {\n      (this.rootNode as HTMLElement).removeChild(childNode);\n    });\n  }\n\n  initPagerLinks(): void {\n    this.pagerLinkNodeArray = getNodeArray({ selector: this.selectors.pagerLink, parent: this.rootNode });\n    this.pagerLinkNodeArray.forEach((pagerLinkNode) => {\n      const { href } = pagerLinkNode as HTMLAnchorElement;\n      if (href) {\n        const layerId = href.split('#')[1];\n        if (layerId) {\n          const layerIndex = this.stateIndexById[layerId];\n          pagerLinkNode.dataset.immerserLayerIndex = layerIndex.toString();\n        }\n      }\n    });\n  }\n\n  initHoverSynchro(): void {\n    this.synchroHoverNodeArray = getNodeArray({ selector: this.selectors.synchroHover, parent: this.rootNode });\n\n    this.onSynchroHoverMouseOver = (e: MouseEvent): void => {\n      const target = e.target as HTMLElement;\n      const synchroHoverId = target.dataset.immerserSynchroHover;\n      this.reactiveSynchroHoverId.value = synchroHoverId;\n    };\n\n    this.onSynchroHoverMouseOut = (): void => {\n      this.reactiveSynchroHoverId.value = undefined;\n    };\n\n    this.synchroHoverNodeArray.forEach((synchroHoverNode) => {\n      synchroHoverNode.addEventListener('mouseover', this.onSynchroHoverMouseOver!);\n      synchroHoverNode.addEventListener('mouseout', this.onSynchroHoverMouseOut!);\n    });\n  }\n\n  attachCallbacks(): void {\n    if (this.pagerLinkNodeArray.length > 0) {\n      this.stopRedrawingPager = this.reactiveActiveLayer.subscribe(this.drawPagerLinks.bind(this));\n    }\n\n    if (this.options.hasToUpdateHash) {\n      this.stopUpdatingHash = this.reactiveActiveLayer.subscribe(this.drawHash.bind(this));\n    }\n\n    if (typeof this.options.onActiveLayerChange === 'function') {\n      this.stopFiringActiveLayerChangeCallback = this.reactiveActiveLayer.subscribe((nextIndex) => {\n        this.options.onActiveLayerChange!(nextIndex, this);\n      });\n    }\n\n    if (this.synchroHoverNodeArray.length > 0) {\n      this.stopTrackingSynchroHover = this.reactiveSynchroHoverId.subscribe(this.drawSynchroHover.bind(this));\n    }\n  }\n\n  detachCallbacks(): void {\n    if (typeof this.stopRedrawingPager === 'function') {\n      this.stopRedrawingPager();\n    }\n\n    if (typeof this.stopUpdatingHash === 'function') {\n      this.stopUpdatingHash();\n    }\n\n    if (typeof this.stopFiringActiveLayerChangeCallback === 'function') {\n      this.stopFiringActiveLayerChangeCallback();\n    }\n\n    if (typeof this.stopTrackingSynchroHover === 'function') {\n      this.stopTrackingSynchroHover();\n    }\n  }\n\n  removeSyncroHoverListeners(): void {\n    this.synchroHoverNodeArray.forEach((synchroHoverNode) => {\n      synchroHoverNode.removeEventListener('mouseover', this.onSynchroHoverMouseOver!);\n      synchroHoverNode.removeEventListener('mouseout', this.onSynchroHoverMouseOut!);\n    });\n  }\n\n  clearCustomSectionIds(): void {\n    this.stateArray.forEach((state) => {\n      if ((state.layerNode as any).__immerserCustomId) {\n        state.layerNode.removeAttribute('id');\n      }\n    });\n  }\n\n  restoreOriginalSolidNodes(): void {\n    this.originalSolidNodeArray.forEach((childNode) => {\n      (this.rootNode as HTMLElement).appendChild(childNode);\n    });\n  }\n\n  cleanupClonnedMarkup(): void {\n    this.maskNodeArray.forEach((immerserMaskNode) => {\n      if (this.isCustomMarkup) {\n        immerserMaskNode.removeAttribute('style');\n        immerserMaskNode.removeAttribute('aria-hidden');\n        const immerserMaskInnerNode = immerserMaskNode.querySelector(this.selectors.maskInner) as HTMLElement;\n        immerserMaskInnerNode.removeAttribute('style');\n        const clonnedSolidNodeArray = getNodeArray({ selector: this.selectors.solid, parent: immerserMaskInnerNode });\n        clonnedSolidNodeArray.forEach((clonnedSolideNode) => {\n          if ((clonnedSolideNode as any).__immerserClonned) {\n            immerserMaskInnerNode.removeChild(clonnedSolideNode);\n          }\n        });\n      } else {\n        (this.rootNode as HTMLElement).removeChild(immerserMaskNode);\n      }\n    });\n  }\n\n  removeScrollAndResizeListeners(): void {\n    if (this.options.isScrollHandled) {\n      window.removeEventListener('scroll', this.onScroll!, false);\n    }\n    window.removeEventListener('resize', this.onResize!, false);\n  }\n\n  draw(scrollY?: number): void {\n    const y = scrollY !== undefined ? scrollY : getLastScrollPosition().y;\n    this.stateArray.forEach(\n      ({ beginEnter, endEnter, beginLeave, endLeave, maskNode, maskInnerNode, layerTop, layerBottom }, layerIndex) => {\n        let progress: number;\n\n        if (beginEnter > y) {\n          progress = this.immerserHeight;\n        } else if (beginEnter <= y && y < endEnter) {\n          progress = endEnter - y;\n        } else if (endEnter <= y && y < beginLeave) {\n          progress = 0;\n        } else if (beginLeave <= y && y < endLeave) {\n          progress = beginLeave - y;\n        } else {\n          progress = -this.immerserHeight;\n        }\n\n        maskNode.style.transform = `translateY(${progress}px)`;\n        maskInnerNode.style.transform = `translateY(${-progress}px)`;\n\n        const pagerScrollActivePoint = y + this.windowHeight * (1 - this.options.pagerThreshold);\n        if (layerTop <= pagerScrollActivePoint && pagerScrollActivePoint < layerBottom) {\n          this.reactiveActiveLayer.value = layerIndex;\n        }\n      },\n    );\n  }\n\n  drawPagerLinks(layerIndex?: number): void {\n    this.pagerLinkNodeArray.forEach((pagerLinkNode) => {\n      if (parseInt(pagerLinkNode.dataset.immerserLayerIndex, 10) === layerIndex) {\n        pagerLinkNode.classList.add(this.options.pagerLinkActiveClassname);\n      } else {\n        pagerLinkNode.classList.remove(this.options.pagerLinkActiveClassname);\n      }\n    });\n  }\n\n  drawHash(layerIndex: number): void {\n    const { id, layerNode } = this.stateArray[layerIndex];\n    layerNode.removeAttribute('id');\n    window.location.hash = id;\n    layerNode.setAttribute('id', id);\n  }\n\n  drawSynchroHover(synchroHoverId?: string): void {\n    this.synchroHoverNodeArray.forEach((synchroHoverNode) => {\n      if (synchroHoverNode.dataset.immerserSynchroHover === synchroHoverId) {\n        synchroHoverNode.classList.add('_hover');\n      } else {\n        synchroHoverNode.classList.remove('_hover');\n      }\n    });\n  }\n\n  adjustScroll(): void {\n    const { layerTop, layerBottom } = this.stateArray[this.reactiveActiveLayer.value as number];\n    const { x, y } = getLastScrollPosition();\n    const topThreshold = Math.abs(y - layerTop);\n    const bottomThreshold = Math.abs(y + this.windowHeight - layerBottom);\n\n    if (topThreshold !== 0 && bottomThreshold !== 0) {\n      if (topThreshold <= bottomThreshold && topThreshold <= this.options.scrollAdjustThreshold) {\n        window.scrollTo(x, layerTop);\n      } else if (bottomThreshold <= topThreshold && bottomThreshold <= this.options.scrollAdjustThreshold) {\n        window.scrollTo(x, layerBottom - this.windowHeight);\n      }\n    }\n  }\n\n  onDOMChange(): void {\n    this.setSizes();\n    this.draw();\n  }\n\n  handleScroll(): void {\n    if (this.isBound) {\n      if (this.scrollFrameId) {\n        window.cancelAnimationFrame(this.scrollFrameId);\n        this.scrollFrameId = null;\n      }\n      this.scrollFrameId = window.requestAnimationFrame(() => {\n        this.draw();\n        if (this.options.scrollAdjustThreshold > 0) {\n          if (this.scrollAdjustTimerId) {\n            clearTimeout(this.scrollAdjustTimerId);\n            this.scrollAdjustTimerId = null;\n          }\n          this.scrollAdjustTimerId = setTimeout(this.adjustScroll.bind(this), this.options.scrollAdjustDelay);\n        }\n      }, this.options.scrollAdjustDelay);\n    }\n  }\n\n  handleResize(): void {\n    if (this.resizeFrameId) {\n      window.cancelAnimationFrame(this.resizeFrameId);\n      this.resizeFrameId = null;\n    }\n    this.resizeFrameId = window.requestAnimationFrame(() => {\n      this.setSizes();\n      this.draw();\n    });\n  }\n}\n"],"names":["root","factory","exports","module","define","amd","this","t","e","Symbol","toPrimitive","r","call","TypeError","String","Observable","callbacks","internal","prototype","subscribe","push","indexOf","slice","concat","key","get","set","length","i","n","enumerable","configurable","writable","Object","defineProperty","o","hasOwnProperty","Array","isArray","optionConfig","userOptions","prefix","a","f","suffix","u","p","strict","d","c","join","s","l","g","v","required","y","default","b","description","x","validator","h","q","E","w","console","warn","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","definition","obj","prop","CLASSNAME_REGEX","OPTION_CONFIG","solidClassnameArray","fromViewportWidth","pagerThreshold","hasToUpdateHash","scrollAdjustThreshold","scrollAdjustDelay","pagerLinkActiveClassname","str","test","isScrollHandled","onInit","onBind","onUnbind","onDestroy","onActiveLayerChange","MESSAGE_PREFFIX","bindStyles","node","styles","rule","style","getNodeArray","_ref","selector","_ref$parent","parent","document","nodeList","querySelectorAll","showError","_ref2","message","_ref2$warning","warning","docs","docsHash","resultMessage","Error","limit","number","min","max","Math","getLastScrollPosition","scrollX","window","documentElement","scrollLeft","scrollY","scrollTop","offsetWidth","offsetHeight","CROPPED_FULL_ABSOLUTE_STYLES","position","top","right","bottom","left","overflow","NOT_INTERACTIVE_STYLES","pointerEvents","touchAction","INTERACTIVE_STYLES","Immerser","_classCallCheck","_defineProperty","layer","solid","pagerLink","mask","maskInner","synchroHover","init","value","setNodes","validateMarkup","mergeOptions","getClassnamesFromMarkup","validateSolidClassnameArray","initSectionIds","initStatemap","validateClassnames","toggleBindOnRezise","setSizes","addScrollAndResizeListeners","options","rootNode","querySelector","selectors","layerNodeArray","solidNodeArray","preffix","_this","forEach","layerNode","layerIndex","dataset","immerserLayerConfig","JSON","parse","error","layerCount","_this2","id","__immerserCustomId","stateIndexById","_this3","stateArray","map","solidClassnames","beginEnter","beginLeave","endEnter","endLeave","layerBottom","layerTop","maskInnerNode","maskNode","every","state","keys","constructor","_this4","stopToggleBindOnRezise","reactiveWindowWidth","nextWindowWidth","isBound","bind","unbind","_this5","documentHeight","windowHeight","innerHeight","immerserTop","offsetTop","immerserHeight","_objectSpread","innerWidth","onScroll","handleScroll","addEventListener","onResize","handleResize","createMarkup","initPagerLinks","initHoverSynchro","attachCallbacks","draw","detachCallbacks","removeSyncroHoverListeners","clearCustomSectionIds","restoreOriginalSolidNodes","cleanupClonnedMarkup","reactiveActiveLayer","pagerLinkNodeArray","originalSolidNodeArray","maskNodeArray","synchroHoverNodeArray","isCustomMarkup","customMaskNodeArray","resizeFrameId","scrollFrameId","scrollAdjustTimerId","reactiveSynchroHoverId","stopRedrawingPager","stopUpdatingHash","stopFiringActiveLayerChangeCallback","stopTrackingSynchroHover","onSynchroHoverMouseOver","onSynchroHoverMouseOut","_this$stopToggleBindO","removeScrollAndResizeListeners","resetInternalState","_this6","initCustomMarkup","stateIndex","createElement","immerserMask","immerserMaskInner","childNode","clonnedChildNode","cloneNode","__immerserClonned","appendChild","callback","index","forEachNode","clonedSolidNode","solidId","immerserSolid","classList","add","setAttribute","detachOriginalSolidNodes","_this7","customMaskNode","customChildrenHTMLCollection","children","_this8","removeChild","_this9","pagerLinkNode","href","layerId","split","immerserLayerIndex","toString","_this0","synchroHoverId","target","immerserSynchroHover","synchroHoverNode","_this1","drawPagerLinks","drawHash","nextIndex","drawSynchroHover","_this10","removeEventListener","removeAttribute","_this11","_this12","immerserMaskNode","immerserMaskInnerNode","clonnedSolideNode","_this13","progress","transform","pagerScrollActivePoint","_this14","parseInt","remove","_this$stateArray$laye","location","hash","_this$stateArray","_getLastScrollPositio","topThreshold","abs","bottomThreshold","scrollTo","_this15","cancelAnimationFrame","requestAnimationFrame","clearTimeout","setTimeout","adjustScroll","_this16"],"ignoreList":[],"sourceRoot":""}