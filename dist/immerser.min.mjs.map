{"version":3,"file":"immerser.min.mjs","sources":["../src/defaults.js","../node_modules/create-observable/index.js","../node_modules/@dubaua/merge-options/dist/merge-options.min.js","../src/utils.js","../src/immerser.js"],"sourcesContent":["const CLASSNAME_REGEX = /^[a-z_-][a-z\\d_-]*$/i;\r\n\r\nfunction classnameValidator(string) {\r\n  return typeof string === 'string' && string !== '' && CLASSNAME_REGEX.test(string);\r\n}\r\n\r\nexport const DEFAULTS = {\r\n  // not redefineable defaults\r\n  selectorImmerser: '[data-immerser]',\r\n  selectorLayer: '[data-immerser-layer]',\r\n  selectorSolid: '[data-immerser-solid]',\r\n  selectorPager: '[data-immerser-pager]',\r\n  selectorPagerLink: '[data-immerser-state-index]',\r\n  selectorMask: '[data-immerser-mask]',\r\n  selectorMaskInner: '[data-immerser-mask-inner]',\r\n  selectorSynchroHover: '[data-immerser-synchro-hover]',\r\n}\r\n\r\nexport const DEFAULT_OPTIONS = {\r\n  // redefineable options\r\n  solidClassnameArray: {\r\n    initial: [],\r\n    description: 'non empty array of objects',\r\n    validator: x => Array.isArray(x) && x.length !== 0,\r\n  },\r\n  fromViewportWidth: {\r\n    initial: 1024,\r\n    description: 'a natural number',\r\n    validator: x => typeof x === 'number' && 0 <= x && x % 1 === 0,\r\n  },\r\n  pagerThreshold: {\r\n    initial: 0.5,\r\n    description: 'a number between 0 and 1',\r\n    validator: x => typeof x === 'number' && 0 <= x && x <= 1,\r\n  },\r\n  hasToUpdateHash: {\r\n    initial: false,\r\n    description: 'boolean',\r\n    validator: x => typeof x === 'boolean',\r\n  },\r\n  scrollAdjustThreshold: {\r\n    initial: 0,\r\n    description: 'a number greater than or equal to 0',\r\n    validator: x => typeof x === 'number' && x >= 0,\r\n  },\r\n  scrollAdjustDelay: {\r\n    initial: 600,\r\n    description: 'a number greater than or equal to 300',\r\n    validator: x => typeof x === 'number' && x >= 300,\r\n  },\r\n  classnamePager: {\r\n    initial: 'pager',\r\n    description: 'valid non empty classname string',\r\n    validator: classnameValidator,\r\n  },\r\n  classnamePagerLink: {\r\n    initial: 'pager__link',\r\n    description: 'valid non empty classname string',\r\n    validator: classnameValidator,\r\n  },\r\n  classnamePagerLinkActive: {\r\n    initial: 'pager__link--active',\r\n    description: 'valid non empty classname string',\r\n    validator: classnameValidator,\r\n  },\r\n  onInit: {\r\n    initial: null,\r\n    description: 'function',\r\n    validator: x => typeof x === 'function',\r\n  },\r\n  onBind: {\r\n    initial: null,\r\n    description: 'function',\r\n    validator: x => typeof x === 'function',\r\n  },\r\n  onUnbind: {\r\n    initial: null,\r\n    description: 'function',\r\n    validator: x => typeof x === 'function',\r\n  },\r\n  onDestroy: {\r\n    initial: null,\r\n    description: 'function',\r\n    validator: x => typeof x === 'function',\r\n  },\r\n  onActiveLayerChange: {\r\n    initial: null,\r\n    description: 'function',\r\n    validator: x => typeof x === 'function',\r\n  },\r\n};\r\n","/**\r\n * Create reactive observable object\r\n *\r\n * @param {any} options.initial initial value\r\n * @param {function} options.onChange a function called after setting a new value\r\n * @returns {object}\r\n *\r\n * @example\r\n *\r\n * @name createObservable\r\n * @function\r\n */\r\nmodule.exports = function(options) {\r\n  var initial = options && options.hasOwnProperty('initial') ? options.initial : undefined;\r\n  var onChange = options && options.hasOwnProperty('onChange') ? options.onChange : undefined;\r\n\r\n  return {\r\n    internal: initial,\r\n    callbacks: typeof onChange === 'function' ? [onChange] : [],\r\n\r\n    get onChange() {\r\n      return this.callbacks;\r\n    },\r\n\r\n    set onChange(callback) {\r\n      if (typeof callback === 'function') {\r\n        this.callbacks.push(callback);\r\n      } else {\r\n        throw new Error('[createObservable] callback must be a function.');\r\n      }\r\n    },\r\n\r\n    get value() {\r\n      return this.internal;\r\n    },\r\n\r\n    set value(next) {\r\n      if (next !== this.internal) {\r\n        var prev = this.internal;\r\n        this.internal = next;\r\n        for (let i = 0; i < this.callbacks.length; i++) {\r\n          this.callbacks[i](this.internal, prev);\r\n        }\r\n      }\r\n    },\r\n  };\r\n};\r\n","\"use strict\";function r(r){return null!==r&&\"object\"==typeof r&&!1===Array.isArray(r)}module.exports=function(t){var e=t.defaults,o=t.userOptions;void 0===o&&(o={});var i=t.warnPreffix;void 0===i&&(i=\"\");var p=t.warnSuffix;if(void 0===p&&(p=\"\"),!r(e))throw new TypeError(\"Expected defaults is required not null, not array object, got \"+typeof e+\" \"+e);if(Object.keys(e).map(function(r){return{key:r,option:e[r]}}).forEach(function(t){var e=t.key,o=t.option;if(!r(o))throw new TypeError(\"Expected each default option is an object, got \"+e+\" is \"+typeof o+\" \"+o);if(!Object.prototype.hasOwnProperty.call(o,\"initial\"))throw new TypeError(\"Expected \"+e+\" have initial property\");if(!Object.prototype.hasOwnProperty.call(o,\"description\"))throw new TypeError(\"Expected \"+e+\" have description property\");var i=o.description;if(\"string\"!=typeof i)throw new TypeError(\"Expected \"+e+\" description is a string, got \"+typeof i+\" \"+i);if(!Object.prototype.hasOwnProperty.call(o,\"validator\"))throw new TypeError(\"Expected \"+e+\" have validator property\");var p=o.validator;if(\"function\"!=typeof p)throw new TypeError(\"Expected \"+e+\" validator is a function, got \"+typeof p+\" \"+p)}),!r(o))throw new TypeError(\"Expected userOptions is required not null, not array object, got \"+typeof o+\" \"+o);if(void 0!==i&&\"string\"!=typeof i)throw new TypeError(\"Expected warnPreffix is optional string, got \"+typeof i+\" \"+i);if(void 0!==p&&\"string\"!=typeof p)throw new TypeError(\"Expected warnSuffix is optional string, got \"+typeof p+\" \"+p);var n={};for(var a in e){var f=e[a],y=f.initial,c=f.description,s=f.validator;if(n[a]=y,Object.prototype.hasOwnProperty.call(o,a)){var d=o[a];s(d)?n[a]=d:console.warn(i,\"Expected \"+a+\" is \"+c+\", got \"+typeof d+\" \"+d+\".\",\"Fallback to default value \"+y+\".\",p)}}return n};\n//# sourceMappingURL=merge-options.min.js.map\n","export function bindStyles(node, styles) {\r\n  for (const rule in styles) {\r\n    node.style[rule] = styles[rule];\r\n  }\r\n}\r\n\r\nexport function forEachNode(nodeList, callback) {\r\n  for (let index = 0; index < nodeList.length; index++) {\r\n    const node = nodeList[index];\r\n    callback(node, index, nodeList);\r\n  }\r\n}\r\n\r\nexport function limit(number, min, max) {\r\n  return Math.max(Math.min(number, max), min);\r\n}\r\n\r\nexport function getLastScrollPosition() {\r\n  const scrollX = window.scrollX || document.documentElement.scrollLeft;\r\n  const scrollY = window.scrollY || document.documentElement.scrollTop;\r\n  // limit scroll position between 0 and document height in case of iOS overflow scroll\r\n  return {\r\n    x: limit(scrollX, 0, document.documentElement.offsetWidth),\r\n    y: limit(scrollY, 0, document.documentElement.offsetHeight),\r\n  };\r\n}\r\n","import { DEFAULTS, DEFAULT_OPTIONS } from './defaults.js';\r\nimport createObservable from 'create-observable';\r\nimport mergeOptions from '@dubaua/merge-options/dist/merge-options.min.js';\r\nimport * as utils from './utils.js';\r\n\r\nexport default class Immerser {\r\n  constructor(userOptions) {\r\n    this.initState();\r\n    this.init(userOptions);\r\n  }\r\n\r\n  initState() {\r\n    this.options = { ...DEFAULTS };\r\n    this.statemap = [];\r\n    this.isBound = false;\r\n    this.isCustomMarkup = false;\r\n    this.immerserNode = null;\r\n    this.pagerNode = null;\r\n    this.originalChildrenNodeList = null;\r\n    this.immerserMaskNodeArray = [];\r\n    this.synchroHoverNodeArray = [];\r\n    this.documentHeight = 0;\r\n    this.windowHeight = 0;\r\n    this.immerserTop = 0;\r\n    this.immerserHeight = 0;\r\n    this.resizeTimerId = null;\r\n    this.scrollTimerId = null;\r\n    this.reactiveSynchroHoverId = createObservable();\r\n    this.reactiveActiveLayer = createObservable();\r\n    this.reactiveWindowWidth = createObservable();\r\n    this.onResize = null;\r\n    this.onScroll = null;\r\n  }\r\n\r\n  init(userOptions) {\r\n    this.options = {\r\n      ...this.options,\r\n      ...mergeOptions({\r\n        defaults: DEFAULT_OPTIONS,\r\n        userOptions,\r\n        warnPreffix: 'immerser:',\r\n        warnSuffix: 'Check out documentation https://github.com/dubaua/immerser#options',\r\n      }),\r\n    };\r\n    this.immerserNode = document.querySelector(this.options.selectorImmerser);\r\n    if (!this.immerserNode) {\r\n      console.warn(\r\n        'immerser: immerser element not found. Check out documentation https://github.com/dubaua/immerser#how-to-use',\r\n      );\r\n      return;\r\n    }\r\n\r\n    this.initStatemap();\r\n    this.setSizes();\r\n\r\n    this.onScroll = this.handleScroll.bind(this);\r\n    this.onResize = this.handleResize.bind(this);\r\n\r\n    window.addEventListener('scroll', this.onScroll, false);\r\n    window.addEventListener('resize', this.onResize, false);\r\n\r\n    if (typeof this.options.onInit === 'function') {\r\n      this.options.onInit(this);\r\n    }\r\n  }\r\n\r\n  initStatemap() {\r\n    const layerNodeList = document.querySelectorAll(this.options.selectorLayer);\r\n    utils.forEachNode(layerNodeList, (layerNode, layerIndex) => {\r\n      let solidClassnames = this.options.solidClassnameArray[layerIndex];\r\n      if (layerNode.dataset.immerserLayerConfig) {\r\n        try {\r\n          solidClassnames = JSON.parse(layerNode.dataset.immerserLayerConfig);\r\n        } catch (e) {\r\n          console.error('Failed to parse JSON class configuration.', e);\r\n        }\r\n      }\r\n\r\n      let id = layerNode.id;\r\n      if (!id) {\r\n        id = `immerser-section-${layerIndex}`;\r\n        layerNode.id = id;\r\n        layerNode.__immerserCustomId = true;\r\n      }\r\n\r\n      this.statemap.push({\r\n        node: layerNode,\r\n        id,\r\n        solidClassnames,\r\n        top: 0,\r\n        bottom: 0,\r\n      });\r\n    });\r\n  }\r\n\r\n  setSizes() {\r\n    // set window sizes\r\n    this.documentHeight = document.documentElement.offsetHeight;\r\n    this.windowHeight = window.innerHeight;\r\n\r\n    // set immerserSizes\r\n    this.immerserTop = this.immerserNode.offsetTop;\r\n    this.immerserHeight = this.immerserNode.offsetHeight;\r\n\r\n    // set layer sizes\r\n    this.statemap = this.statemap.map(state => {\r\n      const top = state.node.offsetTop;\r\n      const bottom = top + state.node.offsetHeight;\r\n      return {\r\n        ...state,\r\n        top,\r\n        bottom,\r\n      };\r\n    });\r\n\r\n    // set statemap\r\n    this.statemap = this.statemap.map((state, index) => {\r\n      const isFirst = index === 0;\r\n      const isLast = index === this.statemap.length - 1;\r\n\r\n      // actually not 0 and this.documentHeight but start of first and end of last.\r\n      const enter = isFirst ? 0 : this.statemap[index - 1].bottom - this.immerserTop;\r\n      const startEnter = isFirst ? 0 : enter - this.immerserHeight;\r\n      const leave = isLast ? this.documentHeight : this.statemap[index].bottom - this.immerserTop;\r\n      const startLeave = isLast ? this.documentHeight : leave - this.immerserHeight;\r\n\r\n      return {\r\n        ...state,\r\n        startEnter,\r\n        enter,\r\n        startLeave,\r\n        leave,\r\n      };\r\n    });\r\n\r\n    this.reactiveWindowWidth.onChange = nextWindowWidth => {\r\n      if (nextWindowWidth >= this.options.fromViewportWidth) {\r\n        if (!this.isBound) {\r\n          this.bind();\r\n        }\r\n      } else if (this.isBound) {\r\n        this.unbind();\r\n      }\r\n    };\r\n    this.reactiveWindowWidth.value = window.innerWidth;\r\n  }\r\n\r\n  initPager() {\r\n    this.reactiveActiveLayer.onChange = nextIndex => {\r\n      if (!this.isBound) return;\r\n\r\n      // draw active pager link\r\n      this.drawPagerLinks(nextIndex);\r\n\r\n      // update hash if the option passed\r\n      if (this.options.hasToUpdateHash) {\r\n        this.updateHash(nextIndex);\r\n      }\r\n\r\n      // fire callback function if the option passed\r\n      if (typeof this.options.onActiveLayerChange === 'function') {\r\n        this.options.onActiveLayerChange(nextIndex, this);\r\n      }\r\n    };\r\n  }\r\n\r\n  createPagerLinks() {\r\n    const { classnamePager, classnamePagerLink } = this.options;\r\n    this.pagerNode.classList.add(classnamePager);\r\n\r\n    this.statemap.forEach((state, index) => {\r\n      const pagerLinkNode = document.createElement('a');\r\n      pagerLinkNode.classList.add(classnamePagerLink);\r\n      pagerLinkNode.href = `#${state.id}`;\r\n\r\n      // store stateIndex in data attribute because it cloned properly\r\n      pagerLinkNode.dataset.immerserStateIndex = index;\r\n\r\n      // bind attribute to synchronize pager link hover\r\n      pagerLinkNode.dataset.immerserSynchroHover = `pager-link-${index}`;\r\n\r\n      this.pagerNode.appendChild(pagerLinkNode);\r\n\r\n      state.pagerLinkNodeArray = [];\r\n    });\r\n  }\r\n\r\n  initPagerLinks() {\r\n    const pagerLinkNodelist = this.immerserNode.querySelectorAll(this.options.selectorPagerLink);\r\n    utils.forEachNode(pagerLinkNodelist, pagerLinkNode => {\r\n      const stateIndex = pagerLinkNode.dataset.immerserStateIndex;\r\n      this.statemap[stateIndex].pagerLinkNodeArray.push(pagerLinkNode);\r\n    });\r\n  }\r\n\r\n  initHoverSynchro(synchroHoverNodeList) {\r\n    this.reactiveSynchroHoverId.onChange = nextId => {\r\n      this.drawSynchroHover(nextId);\r\n    };\r\n\r\n    utils.forEachNode(synchroHoverNodeList, synchroHoverNode => {\r\n      const handleMouseOver = e => {\r\n        const synchroHoverId = e.target.dataset.immerserSynchroHover;\r\n        this.reactiveSynchroHoverId.value = synchroHoverId;\r\n      };\r\n      synchroHoverNode.addEventListener('mouseover', handleMouseOver);\r\n      synchroHoverNode.__immerserHandleMouseOver = handleMouseOver;\r\n\r\n      const handleMouseOut = () => {\r\n        this.reactiveSynchroHoverId.value = undefined;\r\n      };\r\n      synchroHoverNode.addEventListener('mouseout', handleMouseOut);\r\n      synchroHoverNode.__immerserHandleMouseOut = handleMouseOut;\r\n\r\n      this.synchroHoverNodeArray.push(synchroHoverNode);\r\n    });\r\n  }\r\n\r\n  createMasks() {\r\n    const maskStyles = {\r\n      position: 'absolute',\r\n      top: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      left: 0,\r\n      overflow: 'hidden',\r\n    };\r\n\r\n    this.originalChildrenNodeList = this.immerserNode.querySelectorAll(this.options.selectorSolid);\r\n    utils.bindStyles(this.immerserNode, { pointerEvents: 'none', touchAction: 'none' });\r\n\r\n    const customMaskNodeList = this.immerserNode.querySelectorAll(this.options.selectorMask);\r\n    this.isCustomMarkup = customMaskNodeList.length === this.statemap.length;\r\n    if (customMaskNodeList.length > 0 && customMaskNodeList.length !== this.statemap.length) {\r\n      // further possible to explicitly pass mask index\r\n      console.warn(\r\n        \"immerser: You're trying use custom markup, but count of your immerser masks doesn't equal layers count. Check out documentation https://github.com/dubaua/immerser#custom-markup\",\r\n      );\r\n    }\r\n\r\n    // since custom child wrapped in ignoring pointer and touch events immerser mask, we should explicitly set them on\r\n    utils.forEachNode(customMaskNodeList, customMaskNode => {\r\n      const customChildrenHTMLCollection = customMaskNode.querySelector(this.options.selectorMaskInner).children;\r\n      for (let i = 0; i < customChildrenHTMLCollection.length; i++) {\r\n        utils.bindStyles(customChildrenHTMLCollection[i], { pointerEvents: 'all', touchAction: 'auto' });\r\n      }\r\n    });\r\n\r\n    this.statemap = this.statemap.map((state, stateIndex) => {\r\n      // create or assign existing markup, bind styles\r\n      const maskNode = this.isCustomMarkup ? customMaskNodeList[stateIndex] : document.createElement('div');\r\n      utils.bindStyles(maskNode, maskStyles);\r\n      const maskInnerNode = this.isCustomMarkup\r\n        ? maskNode.querySelector(this.options.selectorMaskInner)\r\n        : document.createElement('div');\r\n      utils.bindStyles(maskInnerNode, maskStyles);\r\n\r\n      // clone solids to innerMask\r\n      utils.forEachNode(this.originalChildrenNodeList, childNode => {\r\n        const clonnedChildNode = childNode.cloneNode(true);\r\n        utils.bindStyles(clonnedChildNode, { pointerEvents: 'all', touchAction: 'auto' });\r\n        clonnedChildNode.immerserClonned = true;\r\n        maskInnerNode.appendChild(clonnedChildNode);\r\n      });\r\n\r\n      // assing class modifiers to clonned solids\r\n      const clonedSolidNodeList = maskInnerNode.querySelectorAll(this.options.selectorSolid);\r\n      utils.forEachNode(clonedSolidNodeList, clonedSolidNode => {\r\n        const solidId = clonedSolidNode.dataset.immerserSolid;\r\n        if (state.solidClassnames && state.solidClassnames.hasOwnProperty(solidId)) {\r\n          clonedSolidNode.classList.add(state.solidClassnames[solidId]);\r\n        }\r\n      });\r\n\r\n      // a11y\r\n      if (stateIndex !== 0) {\r\n        maskNode.setAttribute('aria-hidden', 'true');\r\n      }\r\n\r\n      maskNode.appendChild(maskInnerNode);\r\n      this.immerserNode.appendChild(maskNode);\r\n\r\n      this.immerserMaskNodeArray.push(maskNode);\r\n\r\n      return { ...state, maskNode, maskInnerNode };\r\n    });\r\n\r\n    // detach original solid nodes\r\n    utils.forEachNode(this.originalChildrenNodeList, childNode => {\r\n      this.immerserNode.removeChild(childNode);\r\n    });\r\n  }\r\n\r\n  bind() {\r\n    // check if pager, init pager, create links\r\n    this.pagerNode = document.querySelector(this.options.selectorPager);\r\n    if (this.pagerNode) {\r\n      this.initPager();\r\n      this.createPagerLinks();\r\n    }\r\n\r\n    this.createMasks();\r\n\r\n    if (this.pagerNode) {\r\n      this.initPagerLinks();\r\n    }\r\n\r\n    const synchroHoverNodeList = document.querySelectorAll(this.options.selectorSynchroHover);\r\n    if (synchroHoverNodeList.length) {\r\n      this.initHoverSynchro(synchroHoverNodeList);\r\n    }\r\n\r\n    if (typeof this.options.onBind === 'function') {\r\n      this.options.onBind(this);\r\n    }\r\n\r\n    this.isBound = true;\r\n\r\n    this.draw();\r\n    if (this.pagerNode) {\r\n      this.drawPagerLinks(this.reactiveActiveLayer.value);\r\n    }\r\n  }\r\n\r\n  unbind() {\r\n    // detach hover syncro\r\n    this.synchroHoverNodeArray.forEach(synchroHoverNode => {\r\n      synchroHoverNode.removeEventListener('mouseover', synchroHoverNode.__immerserHandleMouseOver);\r\n      synchroHoverNode.removeEventListener('mouseout', synchroHoverNode.__immerserHandleMouseOut);\r\n    });\r\n\r\n    this.statemap.forEach(state => {\r\n      // clear pagerLinkNodeArray\r\n      state.pagerLinkNodeArray = [];\r\n      // clear custom id on layers\r\n      if (state.node.__immerserCustomId) {\r\n        state.node.removeAttribute('id');\r\n      }\r\n    });\r\n\r\n    // restore original children\r\n    utils.forEachNode(this.originalChildrenNodeList, childNode => {\r\n      this.immerserNode.appendChild(childNode);\r\n    });\r\n\r\n    // remove all but custom elements, remove attributes\r\n    this.immerserMaskNodeArray.forEach(immerserMaskNode => {\r\n      // if mask was created\r\n      if (this.isCustomMarkup) {\r\n        // clear mask attributes\r\n        immerserMaskNode.removeAttribute('style');\r\n        immerserMaskNode.removeAttribute('aria-hidden');\r\n        // clear innerMask\r\n        const immerserMaskInnerNode = immerserMaskNode.querySelector(this.options.selectorMaskInner);\r\n        immerserMaskInnerNode.removeAttribute('style');\r\n        // clear clonned solids\r\n        const clonnedSolidNodeList = immerserMaskInnerNode.querySelectorAll(this.options.selectorSolid);\r\n        utils.forEachNode(clonnedSolidNodeList, clonnedSolideNode => {\r\n          if (clonnedSolideNode.immerserClonned) {\r\n            immerserMaskInnerNode.removeChild(clonnedSolideNode);\r\n          }\r\n        });\r\n      } else {\r\n        this.immerserNode.removeChild(immerserMaskNode);\r\n      }\r\n    });\r\n\r\n    this.pagerNode.innerHTML = '';\r\n\r\n    if (typeof this.options.onUnbind === 'function') {\r\n      this.options.onUnbind(this);\r\n    }\r\n\r\n    this.isBound = false;\r\n\r\n    this.reactiveActiveLayer.value = undefined;\r\n  }\r\n\r\n  destroy() {\r\n    this.unbind();\r\n\r\n    window.removeEventListener('scroll', this.onScroll, false);\r\n    window.removeEventListener('resize', this.onResize, false);\r\n\r\n    if (typeof this.options.onDestroy === 'function') {\r\n      this.options.onDestroy(this);\r\n    }\r\n\r\n    this.initState();\r\n  }\r\n\r\n  draw() {\r\n    const { y } = utils.getLastScrollPosition();\r\n    this.statemap.forEach(({ startEnter, enter, startLeave, leave, maskNode, maskInnerNode, top, bottom }, index) => {\r\n      let progress;\r\n\r\n      if (startEnter > y) {\r\n        progress = this.immerserHeight;\r\n      } else if (startEnter <= y && y < enter) {\r\n        progress = enter - y;\r\n      } else if (enter <= y && y < startLeave) {\r\n        progress = 0;\r\n      } else if (startLeave <= y && y < leave) {\r\n        progress = startLeave - y;\r\n      } else if (y >= leave) {\r\n        progress = -this.immerserHeight;\r\n      }\r\n\r\n      maskNode.style.transform = `translateY(${progress}px)`;\r\n      maskInnerNode.style.transform = `translateY(${-progress}px)`;\r\n\r\n      if (this.pagerNode) {\r\n        const pagerScrollActivePoint = y + this.windowHeight * (1 - this.options.pagerThreshold);\r\n        if (top <= pagerScrollActivePoint && pagerScrollActivePoint < bottom) {\r\n          this.reactiveActiveLayer.value = index;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  drawPagerLinks() {\r\n    this.statemap.forEach(({ pagerLinkNodeArray }) => {\r\n      pagerLinkNodeArray.forEach(pagerLinkNode => {\r\n        if (parseInt(pagerLinkNode.dataset.immerserStateIndex, 10) === this.reactiveActiveLayer.value) {\r\n          pagerLinkNode.classList.add(this.options.classnamePagerLinkActive);\r\n        } else {\r\n          pagerLinkNode.classList.remove(this.options.classnamePagerLinkActive);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  drawSynchroHover(synchroHoverId) {\r\n    this.synchroHoverNodeArray.forEach(synchroHoverNode => {\r\n      if (synchroHoverNode.dataset.immerserSynchroHover === synchroHoverId) {\r\n        synchroHoverNode.classList.add('_hover');\r\n      } else {\r\n        synchroHoverNode.classList.remove('_hover');\r\n      }\r\n    });\r\n  }\r\n\r\n  updateHash(stateIndex) {\r\n    const currentState = this.statemap[stateIndex];\r\n    const nextHash = currentState.id;\r\n    // this prevent move to anchor\r\n    currentState.node.removeAttribute('id');\r\n    window.location.hash = nextHash;\r\n    currentState.node.setAttribute('id', nextHash);\r\n  }\r\n\r\n  adjustScroll() {\r\n    const { top, bottom } = this.statemap[this.reactiveActiveLayer.value];\r\n    const { x, y } = utils.getLastScrollPosition();\r\n    const topThreshold = Math.abs(y - top);\r\n    const bottomThreshold = Math.abs(y + this.windowHeight - bottom);\r\n\r\n    if (topThreshold !== 0 && bottomThreshold !== 0) {\r\n      if (topThreshold <= bottomThreshold && topThreshold <= this.options.scrollAdjustThreshold) {\r\n        window.scrollTo(x, top);\r\n      } else if (bottomThreshold <= topThreshold && bottomThreshold <= this.options.scrollAdjustThreshold) {\r\n        window.scrollTo(x, bottom - this.windowHeight);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleScroll() {\r\n    if (this.isBound) {\r\n      this.draw();\r\n      if (this.options.hasToUpdateHash && this.options.scrollAdjustThreshold > 0) {\r\n        if (this.scrollTimerId) clearTimeout(this.scrollTimerId);\r\n        this.scrollTimerId = setTimeout(() => {\r\n          this.adjustScroll();\r\n        }, this.options.scrollAdjustDelay);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleResize() {\r\n    if (this.resizeTimerId) window.cancelAnimationFrame(this.resizeTimerId);\r\n    this.resizeTimerId = window.requestAnimationFrame(() => {\r\n      this.setSizes();\r\n      this.draw();\r\n    });\r\n  }\r\n}\r\n"],"names":["const","CLASSNAME_REGEX","classnameValidator","string","test","DEFAULTS","selectorImmerser","selectorLayer","selectorSolid","selectorPager","selectorPagerLink","selectorMask","selectorMaskInner","selectorSynchroHover","DEFAULT_OPTIONS","solidClassnameArray","initial","description","validator","x","Array","isArray","length","fromViewportWidth","pagerThreshold","hasToUpdateHash","scrollAdjustThreshold","scrollAdjustDelay","classnamePager","classnamePagerLink","classnamePagerLinkActive","onInit","onBind","onUnbind","onDestroy","onActiveLayerChange","options","hasOwnProperty","undefined","onChange","internal","callbacks","this","callback","Error","push","value","next","prev","i","r","bindStyles","node","styles","rule","style","forEachNode","nodeList","let","index","limit","number","min","max","Math","getLastScrollPosition","scrollX","window","document","documentElement","scrollLeft","scrollY","scrollTop","offsetWidth","y","offsetHeight","Immerser","constructor","userOptions","initState","init","Object","statemap","isBound","isCustomMarkup","immerserNode","pagerNode","originalChildrenNodeList","immerserMaskNodeArray","synchroHoverNodeArray","documentHeight","windowHeight","immerserTop","immerserHeight","resizeTimerId","scrollTimerId","reactiveSynchroHoverId","createObservable","reactiveActiveLayer","reactiveWindowWidth","onResize","onScroll","t","e","defaults","o","warnPreffix","p","warnSuffix","TypeError","keys","map","key","option","forEach","prototype","call","n","a","f","c","s","d","console","warn","mergeOptions","querySelector","initStatemap","setSizes","handleScroll","bind","handleResize","addEventListener","querySelectorAll","layerNode","layerIndex","solidClassnames","dataset","immerserLayerConfig","JSON","parse","error","id","__immerserCustomId","innerHeight","offsetTop","state","top","isFirst","isLast","enter","bottom","leave","nextWindowWidth","unbind","innerWidth","initPager","nextIndex","drawPagerLinks","updateHash","createPagerLinks","classList","add","pagerLinkNode","createElement","href","immerserStateIndex","immerserSynchroHover","appendChild","pagerLinkNodeArray","initPagerLinks","initHoverSynchro","synchroHoverNodeList","nextId","drawSynchroHover","synchroHoverNode","handleMouseOver","target","__immerserHandleMouseOver","handleMouseOut","__immerserHandleMouseOut","createMasks","maskStyles","utils","customMaskNodeList","customMaskNode","customChildrenHTMLCollection","children","stateIndex","maskNode","maskInnerNode","childNode","clonnedChildNode","cloneNode","immerserClonned","clonedSolidNode","solidId","immerserSolid","setAttribute","removeChild","draw","removeEventListener","removeAttribute","immerserMaskNode","immerserMaskInnerNode","clonnedSolideNode","innerHTML","destroy","ref","progress","startEnter","startLeave","transform","pagerScrollActivePoint","parseInt","remove","synchroHoverId","currentState","nextHash","location","hash","adjustScroll","topThreshold","abs","bottomThreshold","scrollTo","clearTimeout","setTimeout","cancelAnimationFrame","requestAnimationFrame"],"mappings":"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"}